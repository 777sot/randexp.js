//
// randexp
// Copyright (C) 2011 by Roly Fentanes (https://github.com/fent)
// MIT License
//
(function(){var a={};typeof module!="undefined"&&module.exports&&(module.exports=a);var b=a.types={POSITION:0,CLASS:2,RANGE:3,CLAUSE:6,REFERENCE:7,INTS:"0123456789",WORDS:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",WHITESPACE:" \f\n\r\t  ᠎           \u2028\u2029\u2028\u2029  　"};const c="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",d={0:0,t:9,n:10,v:11,f:12,r:13};var e=a.util={rndChar:function(a){return a[Math.floor(Math.random()*a.length)]},anyRndChar:function(){return String.fromCharCode(e.rndInt(0,65535))},strToChars:function(a){var b=/\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z\[\\\]^?])|([0tnvfr]))/g;return a=a.replace(b,function(a,b,e,f,g,h){var i=b?parseInt(b,16):e?parseInt(e,16):f?parseInt(f,8):g?c.indexOf(g):h?d[h]:undefined,j;return i!==undefined?(j=String.fromCharCode(i),j=j.replace(/[[\]{}^$.|?*+()]/g,function(a){return"\\"+a})):j="\\"+h,j}),a},rndInt:function(a,b){return a+Math.floor(Math.random()*(1+b-a))},findChar:function(a){var b="\\",c="]",d=0;for(;;){var e=a.indexOf(c);if(a[e-1]===b)a=a.slice(++e),d+=e;else return d+e}},range:function(a,c,d){var e=b.WORDS;return e.slice(e.indexOf(c),e.indexOf(d)+1)},classRange:function(a){return a.replace(/(\w)-(\w)/g,e.range)},toBothCases:function(a){var b=a;return b+=a["to"+(a===a.toLowerCase()?"Upper":"Lower")+"Case"](),b},inCaseClass:function(a,b){return b?(a=a.replace(/[a-zA-Z]/g,function(a){return e.toBothCases(a)}),a):a},inCaseChar:function(a,c){return c&&/[a-zA-Z]/.test(a)?{type:b.CLASS,chars:e.toBothCases(a)}:a},flatten:function(a){for(var b=0;b<a.length-1;b++)if(typeof a[b]=="string"){var c=b+1;for(;;){var d=a[c];if(typeof d=="string")a[b]+=d,a.splice(c,1);else break}}return a.length===1?a[0]:a},reduce:function(a){if(a.stack)a.stack=e.flatten(a.stack);else if(a.options)for(var b=0,c=a.options.length;b<c;b++)a.options[b]=e.flatten(a.options[b]);return a.options||a.group||a.value?a:a.stack},nextClose:function(a){var b=0;for(var c=0,d=a.length;c<d;c++){var e=a[c];switch(e){case")":if(b===0)return c+1;b--;break;case"(":b++;break;case"\\":c++}}}};const f={type:b.POSITION,value:"b"},g={type:b.POSITION,value:"B"},h={type:b.POSITION,value:"^"},i={type:b.POSITION,value:"$"},j={type:b.CLASS,chars:b.WORDS},k={type:b.CLASS,chars:b.WORDS,not:!0},l={type:b.CLASS,chars:b.INTS},m={type:b.CLASS,chars:b.INTS,not:!0},n={type:b.CLASS,chars:b.WHITESPACE},o={type:b.CLASS,chars:b.WHITESPACE,not:!0},p={type:b.CLASS,chars:"\n",not:!0};var q=function(a,c,d){var q=0,r,s={type:b.CLAUSE,stack:[]},t=s,u=s.stack,v=[];a=e.strToChars(a);while(q<a.length){r=a[q++];switch(r){case"\\":r=a[q++];switch(r){case"b":u.push(f);break;case"B":u.push(g);break;case"w":u.push(j);break;case"W":u.push(k);break;case"d":u.push(l);break;case"D":u.push(m);break;case"s":u.push(n);break;case"S":u.push(o);break;default:/\d/.test(r)?u.push({type:b.REFERENCE,value:parseInt(r)}):u.push(r)}break;case"^":u.push(h);break;case"$":u.push(i);break;case"[":r=a[q];if(r==="\\"&&a.slice(q+1).indexOf("b]")===0)q+=3,u.push("\b");else{var w;r==="^"?(w=!0,q++):w=!1;var x=a.slice(q),y=e.findChar(x),z=x.substring(0,y);q+=y+1,u.push({type:b.CLASS,chars:e.inCaseClass(e.classRange(z),c),not:w})}break;case".":u.push(p);break;case"(":r=a[q];var A;if(r==="?"){r=a[q+1],q+=2;if(r==="!"){q+=e.nextClose(a.slice(q));break}A=!1}else A=!0;var B={type:b.CLAUSE,group:A,stack:[]};u.push(B),v.push(t),t=B,u=B.stack;break;case")":t=v.pop(),u=t.options?t.options[t.options.length-1]:t.stack;var C=u.length-1;u[C]=e.reduce(u[C]);break;case"|":t.options||(t.options=[t.stack],delete t.stack);var D=[];t.options.push(D),u=D;break;case"{":var E=/^(\d+)(,(\d+)?)?\}/.exec(a.slice(q)),F=parseInt(E[1]),G=E[2]?E[3]?parseInt(E[3]):Infinity:F;q+=E[0].length;var H=u.pop();if(F===G)for(var I=0;I<F;I++)u.push(H);else u.push({type:b.RANGE,min:F,max:G,value:H});break;case"?":var H=u.pop();u.push({type:b.RANGE,min:0,max:1,value:H});break;case"+":var H=u.pop();u.push({type:b.RANGE,min:1,max:Infinity,value:H});break;case"*":var H=u.pop();u.push({type:b.RANGE,min:0,max:Infinity,value:H});break;default:u.push(e.inCaseChar(r,c))}}return e.reduce(s)},r=function(a,c,d,f){if(typeof a=="string")return a;if(a.length){var g="";for(var h=0,i=a.length;h<i;h++)g+=r(a[h],c,d,f);return g}switch(a.type){case b.POSITION:return"";case b.CLASS:if(!a.not)return e.rndChar(a.chars);for(;;){var j=d();if(a.chars.indexOf(j)===-1)return j};case b.RANGE:var k=e.rndInt(a.min,a.max===Infinity?a.min+c:a.max),g="";for(var h=0;h<k;h++)g+=r(a.value,c,d,f);return g;case b.CLAUSE:if(a.options){var k=e.rndInt(0,a.options.length-1);return r(a.options[k],c,d,f)}var l=r(a.stack,c,d,f);return f.push(l),l;case b.REFERENCE:return f[a.value-1]}};RegExp.prototype.__defineGetter__("gen",function(){return this._randexp===undefined&&(this._randexp=q(this.source,this.ignoreCase,this.multiline),this._max=this._max||100,this._anyRndChar=this._anyRndChar||e.anyRndChar),r(this._randexp,this._max,this._anyRndChar,[])})})();